"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const procSpin_1 = require("./procSpin");
const uniqueId_1 = require("./uniqueId");
const timer_1 = require("../timer");
describe('Spin', () => {
    test('isA', () => {
        expect((0, procSpin_1.isSpinRequest)({})).toBe(false);
        expect((0, procSpin_1.isSpinRequest)({ id: (0, uniqueId_1.createId)(), requestType: 'Spin' })).toBe(true);
    });
    test('Spin for 5ms', async () => {
        const req = (0, procSpin_1.createRequestSpin)({ durationMs: 5 });
        const m = await (0, timer_1.measurePromise)(() => (0, procSpin_1.procSpin)(req));
        const r = m.r;
        expect(r.id).toBe(req.id);
        expect(r.responseType).toBe('Spin');
        expect(r.data).toEqual(expect.objectContaining({
            count: expect.any(Number),
            elapsedTimeMs: expect.any(Number),
        }));
        expect(m.elapsedTimeMs).toBeGreaterThan(req.data.durationMs);
    });
    test('Bad Request', async () => {
        const req = { id: (0, uniqueId_1.createId)(), requestType: 'Spin', data: {} };
        const r = await (0, procSpin_1.procSpin)(req);
        expect(r.responseType).toBe('Error');
    });
});
//# sourceMappingURL=procSpin.test.js.map