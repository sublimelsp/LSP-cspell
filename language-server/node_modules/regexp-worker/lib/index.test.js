"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _1 = require(".");
describe('Validate Index', () => {
    test('quick test RegExpWorker', run(async (w) => {
        const r = await w.execRegExp(/./g, 'hello', 500);
        expect(r.elapsedTimeMs).toBeGreaterThan(0);
        expect(r.elapsedTimeMs).toBeLessThan(10);
        expect(r.matches.map((m) => m[0])).toEqual('hello'.split(''));
    }));
    test('Auto cleanup after delay', async () => {
        const w = new _1.RegExpWorker();
        const r = await w.execRegExp(/./g, 'hello', 500);
        expect(r.elapsedTimeMs).toBeGreaterThan(0);
        expect(r.elapsedTimeMs).toBeLessThan(10);
        expect(r.matches.map((m) => m[0])).toEqual('hello'.split(''));
        await delay(500);
    });
});
function run(fn, w = new _1.RegExpWorker()) {
    return () => fn(w).finally(w.dispose).then();
}
function delay(ms) {
    return new Promise((resolve) => {
        setTimeout(resolve, ms);
    });
}
//# sourceMappingURL=index.test.js.map